services:
  # Web Service using Docker
  - type: web
    name: face-recognition-app
    runtime: docker
    region: oregon
    plan: free
    branch: main
    dockerfilePath: ./Dockerfile
    envVars:
      - key: FLASK_SECRET
        generateValue: true
      - key: CREATE_ADMIN_SECRET
        generateValue: true
      - key: MONGODB_URI
        sync: false  # Set this manually in Render dashboard
      - key: PORT
        value: "10000"
      - key: ADMIN_EMAIL
        value: admin@admin.com
      - key: ADMIN_PASSWORD
        value: password123
      # TensorFlow/Keras environment variables (CRITICAL for fixing Keras import)
      - key: TF_USE_LEGACY_KERAS
        value: "1"
      - key: TF_CPP_MIN_LOG_LEVEL
        value: "3"
      - key: TF_ENABLE_ONEDNN_OPTS
        value: "0"
      - key: PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION
        value: python
    healthCheckPath: /health